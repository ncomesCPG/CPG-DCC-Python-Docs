<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cpg.maya.tools.face_staging.face_staging_ui &mdash; CPG DCC Maya Python 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            CPG DCC Maya Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../modules.html">cpg-maya</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">CPG DCC Maya Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">cpg.maya.tools.face_staging.face_staging_ui</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for cpg.maya.tools.face_staging.face_staging_ui</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Source data for faces.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># python imports</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># PySide2 imports</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QFont</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QAbstractItemView</span><span class="p">,</span> <span class="n">QDialogButtonBox</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QLayout</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QListWidgetItem</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QSizePolicy</span>

<span class="c1"># software specific imports</span>
<span class="kn">import</span> <span class="nn">pymel.core</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">maya.cmds</span> <span class="k">as</span> <span class="nn">cmds</span>

<span class="c1"># CPG python imports</span>
<span class="kn">from</span> <span class="nn">cpg.common</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">cpg.common.paths</span> <span class="kn">import</span> <span class="n">paths</span>
<span class="kn">from</span> <span class="nn">cpg.common.utils</span> <span class="kn">import</span> <span class="n">fileio</span><span class="p">,</span> <span class="n">sounds</span><span class="p">,</span> <span class="n">lists</span>
<span class="kn">from</span> <span class="nn">cpg.common.modifiers</span> <span class="kn">import</span> <span class="n">decorators</span>
<span class="kn">from</span> <span class="nn">cpg.common.assetlist</span> <span class="kn">import</span> <span class="n">assetlist</span>
<span class="kn">from</span> <span class="nn">cpg.common.tools.progressbar</span> <span class="kn">import</span> <span class="n">progressbar_ui</span>
<span class="kn">from</span> <span class="nn">cpg.common.resources</span> <span class="kn">import</span> <span class="n">resources</span>
<span class="kn">from</span> <span class="nn">cpg.common.pyqt.qt_utils</span> <span class="kn">import</span> <span class="n">listwidget_utils</span>

<span class="kn">from</span> <span class="nn">cpg.maya.modifiers</span> <span class="kn">import</span> <span class="n">ma_decorators</span>
<span class="kn">from</span> <span class="nn">cpg.maya.rigging</span> <span class="kn">import</span> <span class="n">frag</span><span class="p">,</span> <span class="n">skel_utils</span>
<span class="kn">from</span> <span class="nn">cpg.maya.modeling</span> <span class="kn">import</span> <span class="n">face_model</span>
<span class="kn">from</span> <span class="nn">cpg.maya.face</span> <span class="kn">import</span> <span class="n">source_meshes</span><span class="p">,</span> <span class="n">face_vertex_data</span><span class="p">,</span> <span class="n">source_data</span>
<span class="kn">from</span> <span class="nn">cpg.maya.rigging.flags</span> <span class="kn">import</span> <span class="n">flag_utils</span><span class="p">,</span> <span class="n">frag_flag</span><span class="p">,</span> <span class="n">serialize_flag</span>
<span class="kn">from</span> <span class="nn">cpg.maya.rigging</span> <span class="kn">import</span> <span class="n">mesh_markup_rig</span><span class="p">,</span> <span class="n">chain_markup</span>
<span class="kn">from</span> <span class="nn">cpg.maya.face.face_utils</span> <span class="kn">import</span> <span class="n">face_util</span><span class="p">,</span> <span class="n">face_import_export</span><span class="p">,</span> <span class="n">eyelash_snapping</span><span class="p">,</span> <span class="n">face_skinning</span>
<span class="kn">from</span> <span class="nn">cpg.maya.face.face_poses</span> <span class="kn">import</span> <span class="n">pose_files</span>
<span class="kn">from</span> <span class="nn">cpg.maya.face.face_poses</span> <span class="kn">import</span> <span class="n">face_pose_edit</span>
<span class="kn">from</span> <span class="nn">cpg.maya.utils</span> <span class="kn">import</span> <span class="n">optionvars</span><span class="p">,</span> <span class="n">fbx_utils</span><span class="p">,</span> <span class="n">naming</span><span class="p">,</span> <span class="n">display_layers</span><span class="p">,</span> <span class="n">textures</span>
<span class="kn">from</span> <span class="nn">cpg.maya.deformations</span> <span class="kn">import</span> <span class="n">skin_utils</span>
<span class="kn">from</span> <span class="nn">cpg.maya.pyqt</span> <span class="kn">import</span> <span class="n">mayawindows</span>
<span class="kn">from</span> <span class="nn">cpg.maya.tools.faceskinning</span> <span class="kn">import</span> <span class="n">face_skinning_tool</span>
<span class="kn">from</span> <span class="nn">cpg.maya.tools.assetregister</span> <span class="kn">import</span> <span class="n">ma_asset_register</span>
<span class="kn">from</span> <span class="nn">cpg.maya.pyqt</span> <span class="kn">import</span> <span class="n">dialogs</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">CPG_LOGGER</span>
<span class="n">TEMPLATES_PATH</span> <span class="o">=</span> <span class="s1">&#39;cpg.maya.rigging.templates&#39;</span>

<span class="n">STAGING_COLOR_GREEN</span> <span class="o">=</span> <span class="s1">&#39;(0, 255, 0)&#39;</span>
<span class="n">STAGING_COLOR_RED</span> <span class="o">=</span> <span class="s1">&#39;(255, 0, 0)&#39;</span>
<span class="n">STAGING_COLOR_WHITE</span> <span class="o">=</span> <span class="s1">&#39;(255, 255, 255)&#39;</span>
<span class="n">STAGING_COLOR_GREY</span> <span class="o">=</span> <span class="s1">&#39;(150, 150, 150)&#39;</span>
<span class="n">STAGING_BUTTON_COLORS</span> <span class="o">=</span> <span class="s1">&#39;background-color: rgb{0.207843, 0.207843, 0.207843, 1.000000};&#39;</span>
<span class="n">STAGING_BUTTON_ACTIVE_COLORS</span> <span class="o">=</span> <span class="s1">&#39;background-color: #696969; color: black;&#39;</span>
<span class="n">STAGING_BACKGROUND_GREY</span> <span class="o">=</span> <span class="s1">&#39;background-color: #808080;&#39;</span>
<span class="n">REGION_LOGO_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="sa">r</span><span class="s1">&#39;Icons&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="CPGFaceStagingOptionVars"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.CPGFaceStagingOptionVars">[docs]</a><span class="k">class</span> <span class="nc">CPGFaceStagingOptionVars</span><span class="p">(</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGOptionVars</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Option vars for the Face Staging UI</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># strings</span>
    <span class="n">CPGFaceStagingContentPath</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Branch content path.&#39;</span><span class="p">}</span>

    <span class="c1"># bools</span>
    <span class="n">CPGFaceStagingShowSkeleton</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Face Mesh Edit Show Skeleton.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingAutoMeshExport</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto Export mesh after editing.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingAutoMeshMirror</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto Mirror mesh after editing.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingTransferJoints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Transfers Joints to the editing mesh.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingSymmetry</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets the symmetry options when editing.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingSaveBlendShapes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to save the blendshape rig scene.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingExportShapes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to export blend shapes.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingExportSK</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to export SK.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingProcessSkinning</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to process skinning.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingSaveRig</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to save out cleaned up rig.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingImportSourceHead</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets whether to import the source head.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingOpeningSound</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Plays and opening sound if True.&#39;</span><span class="p">}</span>
    <span class="c1"># int/float</span>
    <span class="n">CPGFaceStagingUITab</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Latest Tab opened.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingSourceHead</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Source head for this rig.&#39;</span><span class="p">}</span>
    <span class="n">CPGFaceStagingAssetID</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">:</span> <span class="s1">&#39;Asset id for this rig.&#39;</span><span class="p">}</span>


    <span class="c1">######################</span>
    <span class="c1"># For easier reading</span>
    <span class="c1">######################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">common_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an easier name for the latest tab selected.</span>
<span class="sd">        :return string: Returns an easier name for the latest tab selected.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingContentPath</span>

    <span class="nd">@common_folder</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">common_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an easier name for the latest tab selected.</span>
<span class="sd">        :param value: Sets an easier name for the latest tab selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingContentPath</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an easier name for the latest tab selected.</span>
<span class="sd">        :return string: Returns an easier name for the latest tab selected.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingUITab</span>

    <span class="nd">@tabs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an easier name for the latest tab selected.</span>
<span class="sd">        :param value: Sets an easier name for the latest tab selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingUITab</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">open_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an easier name for the latest tab selected.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingOpeningSound</span>

    <span class="nd">@open_sound</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">open_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an easier name for the latest tab selected.</span>
<span class="sd">        :param value: Sets an easier name for the latest tab selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingOpeningSound</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source_head_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns Source head index in combo box.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingSourceHead</span>

    <span class="nd">@source_head_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source_head_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets source head index in combo box.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingSourceHead</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">asset_id_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns asset id index in combo box.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingAssetID</span>

    <span class="nd">@asset_id_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">asset_id_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets asset id index in combo box.</span>
<span class="sd">        :rtype: Int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CPGFaceStagingAssetID</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="FaceStagingUI"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI">[docs]</a><span class="k">class</span> <span class="nc">FaceStagingUI</span><span class="p">(</span><span class="n">mayawindows</span><span class="o">.</span><span class="n">CPGMayaWindow</span><span class="p">):</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="s1">&#39;1.0.0&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">root_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())))</span>
        <span class="n">ui_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_path</span><span class="p">,</span> <span class="s1">&#39;ui&#39;</span><span class="p">,</span> <span class="s1">&#39;face_staging_ui.ui&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span>
                         <span class="n">ui_path</span><span class="o">=</span><span class="n">ui_path</span><span class="p">,</span>
                         <span class="n">version</span><span class="o">=</span><span class="n">FaceStagingUI</span><span class="o">.</span><span class="n">VERSION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span> <span class="o">=</span> <span class="n">CPGFaceStagingOptionVars</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_component</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_markup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_node</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">()</span>

        <span class="c1">###############################</span>
        <span class="c1"># Signals</span>
        <span class="c1">###############################</span>
        
        <span class="c1"># Tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">staging_tabWidget</span><span class="o">.</span><span class="n">currentChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_tabs</span><span class="p">)</span>

        <span class="c1"># Tool Bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">zero_flags_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zero_flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">flags_v_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags_visibility</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">mirror_toolbar_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mirror_selected_vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">eyelash_snap_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eyelash_snap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">apply_animation_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calibration_animation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cut_animation_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cut_animation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">overlay_on_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_overlay_texture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">overlay_off_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_overlay_texture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skinning_toolbar_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_skinning_tools</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">new_head_plus_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">register_new_head</span><span class="p">)</span>

        <span class="c1"># asset id - top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_asset_id_change</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">open_model_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_model_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">open_model_build_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_open_model_build_rig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">source_head_comboBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_source_head_selection_optionvars</span><span class="p">)</span>

        <span class="c1"># Mesh Info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">add_tags_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_markup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_markup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">remove_tags_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_remove_markup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">select_mesh_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_marked_up_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">create_rig_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_rig_existing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">create_process_rig_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_rig_generate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_remove_markup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_region_logo</span><span class="p">)</span>

        <span class="c1"># Mesh Edit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">toggle_local_axis_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_local_axis_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">update_bs_list_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_populate_edit_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_populate_poses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">itemClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_populate_poses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">update_poses_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_populate_poses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_edit_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_edit_toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_edit_cancel_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_edit_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_replace_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replace_base_mesh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">single_pose_toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cancel_edit_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pose_edit_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_pose_toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paint_neutral_toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_blendshape_edit_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_list_listWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_skinned_edit_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_pose_flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">mirror_pose_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mirror_pose_from_listwidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">mirror_all_poses_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mirror_all_poses</span><span class="p">)</span>

        <span class="c1"># Rigging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">sl_rest_skin_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restore_skinning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">sl_exp_skin_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_skinning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">sl_proc_skin_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_skinning_delete_mesh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">all_proc_skin_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_meshes_process_skinning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_rig_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">finish_save_rig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">all_exp_skin_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_all_skinning</span><span class="p">)</span>

        <span class="c1">##### Check boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_edit_show_skeleton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_auto_export_mesh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_auto_mirror_mesh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_transfer_joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_edit_symmetry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_blendshape_scene_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_save_blendshape_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_shapes_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_export_shapes_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_sk_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_export_sk_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">generate_process_skinning_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_process_skinning_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_rig_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_save_rig_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_source_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_import_source_head_optionvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">opening_sound_checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_opening_sound_optionvars</span><span class="p">)</span>

        <span class="c1"># Menu Bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionRefresh_UI</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refreshUI</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionSelected_Blend_Shapes</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_export_selected</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionAll_Blend_Shapes</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_export_all_blendshapes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionModel_File_2</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_skin_meshes_as_ma</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionBase_Meshes_as_FBX</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_skin_meshes_as_fbx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionFrom_Common_Location</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_from_common</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionFrom_Asset_Location</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_from_asset_location</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionCommone_Models</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_common_in_explorer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionAsset_Location</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_asset_location_in_explorer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionImportSkeleton</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_skeleton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionExport_Skeleton</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_skeleton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionDocumentation</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tools_documentation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionPipeline_Documentation</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pipeline_documentation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionPose_Documentation</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sculpting_documentation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionSkeletal_Mesh</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_skeletal_mesh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionAnimation_Pose_File</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_pose_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionAnimation_Poses</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">create_pose_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionFrame_Poses</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_frame_pose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionSource_Head_And_Data</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_source_meshes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionRe_Connect_Blendshapes</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reconnect_shapes_to_rig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionSave_Animation_File</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_calibration_animation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">actionRun_Skin_Converter_No_Delete_Source</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_skinning_keep_mesh</span><span class="p">)</span>

        <span class="c1"># Vertex Snapping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">expand_snapping_tools_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_expand_snapping_tools_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">top_to_bottom_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_top_to_bottom_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bottom_to_top_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_bottom_to_top_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">meet_at_middle_pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_meet_at_middle_clicked</span><span class="p">)</span>

    <span class="c1">###############################</span>
    <span class="c1"># Slots</span>
    <span class="c1">###############################</span>
    <span class="k">def</span> <span class="nf">_on_startup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initial commands on when opening the UI</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_asset_ids</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asset_id_from_name</span><span class="p">()</span>
        <span class="c1"># Updates the regions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_source_heads</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">staging_tabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">tabs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">asset_id_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_asset_id_change</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">source_head_comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">source_head_selection</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>

        <span class="c1"># Button Icons</span>
        <span class="n">my_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;flag_white&#39;</span><span class="p">)</span>
        <span class="n">flags_vis</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;font_awesome_flag_64px&#39;</span><span class="p">)</span>
        <span class="n">mirror_vert_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;reflection&#39;</span><span class="p">)</span>
        <span class="n">eyelash_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;eye_closed&#39;</span><span class="p">)</span>
        <span class="n">animation_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;animation&#39;</span><span class="p">)</span>
        <span class="n">cut_anim_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;unavailable&#39;</span><span class="p">)</span>
        <span class="n">overlay_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;queue&#39;</span><span class="p">)</span>
        <span class="n">overlay_close_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">)</span>
        <span class="n">skin_tools_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;tool&#39;</span><span class="p">)</span>
        <span class="n">new_head_plus_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;plus&#39;</span><span class="p">)</span>
        <span class="n">expand_snapping_tools_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;expand&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">zero_flags_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">my_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">mirror_toolbar_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">mirror_vert_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">eyelash_snap_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">eyelash_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">flags_v_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">flags_vis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">apply_animation_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">animation_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cut_animation_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">cut_anim_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">overlay_on_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">overlay_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">overlay_off_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">overlay_close_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skinning_toolbar_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">skin_tools_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">new_head_plus_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">new_head_plus_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">expand_snapping_tools_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">expand_snapping_tools_icon</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertex_snapping_frame</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

        <span class="c1"># Set face region Icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_region_logo</span><span class="p">()</span>

        <span class="c1"># Set the edit buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ui_on_open</span><span class="p">()</span>

        <span class="c1"># set check boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingShowSkeleton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingAutoMeshExport</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingAutoMeshMirror</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingTransferJoints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSymmetry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_blendshape_scene_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSaveBlendShapes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_shapes_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingExportShapes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_sk_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingExportSK</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">generate_process_skinning_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingProcessSkinning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_rig_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSaveRig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_source_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingImportSourceHead</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_source_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingImportSourceHead</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">opening_sound_checkBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">open_sound</span><span class="p">)</span>

        <span class="c1"># Color dividers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tool_divider_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">flags_divide_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">overlay_divide_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">eyelash_divide_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">mirror_divide_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_tools_divide_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">opening_sound_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">sounds</span><span class="o">.</span><span class="n">sound_tada</span><span class="p">()</span>

<div class="viewcode-block" id="FaceStagingUI.tab_start_ups"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.tab_start_ups">[docs]</a>    <span class="k">def</span> <span class="nf">tab_start_ups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">staging_tabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">skinned_regions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">skinned_regions_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_regions</span><span class="p">(</span><span class="n">skinned_regions</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_poses</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_blendshape_meshes</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_edit_meshes</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_skinning_meshes</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.set_region_logo"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.set_region_logo">[docs]</a>    <span class="k">def</span> <span class="nf">set_region_logo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the logo that corresponds with the selected region in the list Widget on the mesh info.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">region</span> <span class="o">=</span> <span class="n">listwidget_utils</span><span class="o">.</span><span class="n">get_qlist_widget_selected_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">region</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">region_icons_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">())</span>
            <span class="k">return</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">race</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">race</span>
        <span class="n">logo</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REGION_LOGO_PATH</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">race</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1">.JPG&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">logo</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">region_icons_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">())</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">region_icons_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="n">logo</span><span class="p">))</span></div>
        <span class="c1"># self.ui.region_icons_pushButton.setIconSize(QtCore.QSize(150,200))</span>

<div class="viewcode-block" id="FaceStagingUI.tools_documentation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.tools_documentation">[docs]</a>    <span class="k">def</span> <span class="nf">tools_documentation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the Confluence page for the face tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://counterplay.atlassian.net/wiki/spaces/CGH/pages/1911488547/Face+Staging+Tool&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.pipeline_documentation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.pipeline_documentation">[docs]</a>    <span class="k">def</span> <span class="nf">pipeline_documentation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the Confluence page for the face tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://counterplay.atlassian.net/wiki/spaces/CGH/pages/1700921367/Face+Workflow+and+Pipeline&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.sculpting_documentation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.sculpting_documentation">[docs]</a>    <span class="k">def</span> <span class="nf">sculpting_documentation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the Confluence page for the face tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://counterplay.atlassian.net/wiki/spaces/CGH/pages/1923776513/Sculpting+Poses&#39;</span><span class="p">)</span></div>

    <span class="c1">##############################################</span>
    <span class="c1"># Set optionvars on Check boxes, Tabs, etc...</span>
    <span class="c1">##############################################</span>
    <span class="k">def</span> <span class="nf">_set_tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the optionvar that keeps track of which tab was selected and updates the tab info.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">staging_tabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">tabs</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_start_ups</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_edit_show_skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox to show the skeleton when editing a mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingShowSkeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_auto_export_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox to Auto Export mesh after editing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingAutoMeshExport</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_auto_mirror_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox to Auto Mirror mesh after editing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingAutoMeshMirror</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_edit_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for setting symmetry automatically when needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSymmetry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_transfer_joints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for trasnfer joints.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingTransferJoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_save_blendshape_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for saving blendshape.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSaveBlendShapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_blendshape_scene_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_export_shapes_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for exporting shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingExportShapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_shapes_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_export_sk_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for exporting shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingExportSK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_sk_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_process_skinning_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for exporting shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingProcessSkinning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">generate_process_skinning_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_save_rig_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for exporting shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingSaveRig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_rig_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_import_source_head_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for importing source head.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">CPGFaceStagingImportSourceHead</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_source_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_opening_sound_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar checkbox for opening sound.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">open_sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">opening_sound_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_source_head_selection_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar for source head selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">source_head_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">source_head_comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_asset_id_selection_optionvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optionvar for asset_id selection</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optionvars</span><span class="o">.</span><span class="n">asset_id_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate_source_heads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the source head comboBox.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">face_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;SourceHeads&#39;</span><span class="p">)</span>
        <span class="n">source_files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">face_path</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">source_head_comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">source_files</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate_asset_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the asset ids in the combo box.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">head_asset_dict</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_category_dict</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">cpg_asset</span> <span class="ow">in</span> <span class="n">head_asset_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span><span class="p">,</span> <span class="n">cpg_asset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        asset_list = assetlist.AssetList()</span>
<span class="sd">        self.asset_id_dict = {}</span>
<span class="sd">        display_names = []</span>
<span class="sd">        asset_id_list = asset_list.get_asset_ids(&#39;head&#39;)</span>
<span class="sd">        for asset_id in asset_id_list:</span>
<span class="sd">            asset = assetlist.AssetIDList(asset_id)</span>
<span class="sd">            self.asset_id_dict.setdefault(asset.display_name, asset)</span>
<span class="sd">            display_names.append(asset.display_name)</span>

<span class="sd">        self.ui.asset_comboBox.addItems(display_names)</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FaceStagingUI.get_asset_id_from_name"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_asset_id_from_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_asset_id_from_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the asset id of the chosen rig&#39;s Display Name</span>

<span class="sd">        :return: Returns the asset id of the chosen rig&#39;s Display Name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">display_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">asset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">display_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">asset</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">asset</span><span class="o">.</span><span class="n">asset_id</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_asset_sm_name_path"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_asset_sm_name_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_asset_sm_name_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the asset name of the chosen rig&#39;s Display Name</span>

<span class="sd">        :return: Returns the asset name of the chosen rig&#39;s Display Name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">display_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">asset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">display_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">sm_path</span>
        <span class="k">return</span> <span class="n">full_path</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_asset_sk_name_path"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_asset_sk_name_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_asset_sk_name_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the asset name of the chosen rig&#39;s Display Name</span>

<span class="sd">        :return: Returns the asset name of the chosen rig&#39;s Display Name</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">display_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">asset_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">asset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">display_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">sk_path</span>
        <span class="k">return</span> <span class="n">full_path</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_face_region_data"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_face_region_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_face_region_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the face data from a text file.  Sets the FaceMeshRegionData.</span>

<span class="sd">        :param str region: The data associated with a specific type of mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span> <span class="o">=</span> <span class="n">source_data</span><span class="o">.</span><span class="n">FaceMeshRegionData</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.reset_pose_edit_buttons"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.reset_pose_edit_buttons">[docs]</a>    <span class="k">def</span> <span class="nf">reset_pose_edit_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_single</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the edit buttons in the UI back to it&#39;s original colors.</span>
<span class="sd">        :param bool keep_single: If True, the single pose edit buttons will not reset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_single</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_inactive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_color_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_inactive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_inactive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_inactive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_color_edit_frame</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.set_ui_on_open"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.set_ui_on_open">[docs]</a>    <span class="k">def</span> <span class="nf">set_ui_on_open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the Pose Edit buttons on start up, depending on what state the scene is in.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_start_ups</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_color_frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">multi_pose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">base_edit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_edit_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_color_edit_frame</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_frame</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.set_edit_buttons_active"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.set_edit_buttons_active">[docs]</a>    <span class="k">def</span> <span class="nf">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a QPushButton and a Qframe to the active color.</span>

<span class="sd">        :param QPushButton button: The QT button that the color is being applied.</span>
<span class="sd">        :param Qframe frame: The QT Frame that the color is being applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_ACTIVE_COLORS</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BACKGROUND_GREY</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.set_edit_buttons_inactive"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.set_edit_buttons_inactive">[docs]</a>    <span class="k">def</span> <span class="nf">set_edit_buttons_inactive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a QPushButton and a Qframe to the inactive color.</span>

<span class="sd">        :param QPushButton button: The QT button that the color is being applied.</span>
<span class="sd">        :param Qframe frame: The QT Frame that the color is being applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_COLORS</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_COLORS</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_display_layers"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_display_layers">[docs]</a>    <span class="k">def</span> <span class="nf">get_display_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets all the display layers from frag.DisplayLayers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="n">dsp_lyrs</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">get_frag_children</span><span class="p">(</span><span class="n">of_type</span><span class="o">=</span><span class="n">frag</span><span class="o">.</span><span class="n">DisplayLayers</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dsp_lyrs</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">dsp_lyrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="c1">####################</span>
    <span class="c1"># Menu Bar</span>
    <span class="c1">####################</span>
    <span class="c1"># File</span>
    <span class="c1"># Export</span>

<div class="viewcode-block" id="FaceStagingUI.print_frame_pose"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.print_frame_pose">[docs]</a>    <span class="k">def</span> <span class="nf">print_frame_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints a list of frame numbers with the pose name</span>

<span class="sd">        :return: Returns a dictionary with frame numbers with the pose name</span>
<span class="sd">        :rtype: Dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frame_pose</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_parameters_region_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="s1">&#39;head_blendshape&#39;</span><span class="p">)</span>
        <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get_parameters_list</span><span class="p">(</span><span class="n">sort_by_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">parameter</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">parameter</span><span class="o">.</span><span class="n">parameter_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">frame_pose</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">parameter</span><span class="o">.</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frame_pose</span></div>

<div class="viewcode-block" id="FaceStagingUI.add_overlay_texture"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.add_overlay_texture">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">add_overlay_texture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a Clown Mask to the selected objs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">objs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">objs</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">hasAttr</span><span class="p">(</span><span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">CPG_MESH_MARKUP</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">objs</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">region_data</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_face_region_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
            <span class="n">overlay_path</span> <span class="o">=</span> <span class="n">region_data</span><span class="o">.</span><span class="n">clown_mask</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">overlay_path</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">overlay_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="n">overlay_path</span><span class="p">)</span>
            <span class="n">textures</span><span class="o">.</span><span class="n">add_overlay_textures</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">overlay_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.remove_overlay_texture"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.remove_overlay_texture">[docs]</a>    <span class="k">def</span> <span class="nf">remove_overlay_texture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the Clown Mask from selected objs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">textures</span><span class="o">.</span><span class="n">remove_overlay_textures</span><span class="p">()</span></div>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">_export_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports selected blend shapes to the asset directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">sl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Check to see if the there is source data loaded.  # Data about the face meshes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_face_blendshape_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">region_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">regions_list</span>

        <span class="n">blendshape_regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">region_list</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;regions&#39;</span><span class="p">][</span><span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mesh_category&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">category</span> <span class="ow">and</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;blendshape_mesh&#39;</span><span class="p">:</span>
                <span class="n">blendshape_regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="n">verified_pose</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">blendshape_regions</span><span class="p">:</span>
            <span class="n">parameter_inst</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_parameters_region_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
            <span class="n">pose_list</span> <span class="o">=</span> <span class="n">parameter_inst</span><span class="o">.</span><span class="n">get_pose_list</span><span class="p">()</span>
            <span class="p">[</span><span class="n">verified_pose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">selection</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]</span>

        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">verified_pose</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">confirmDialog</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export and Save Pose?&#39;</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Export these poses?</span><span class="se">\n</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="n">button</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
                                    <span class="n">defaultButton</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span>
                                    <span class="n">cancelButton</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">,</span>
                                    <span class="n">dismissString</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">pose_grp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pose_grp</span><span class="p">()</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">verified_pose</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">face_import_export</span><span class="o">.</span><span class="n">export_blendshapes</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">meshes</span><span class="o">=</span><span class="n">verified_pose</span><span class="p">,</span> <span class="n">remove_mtls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pose_grp</span><span class="p">:</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">verified_pose</span><span class="p">,</span> <span class="n">pose_grp</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Blend Shapes Exported&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">_export_all_blendshapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports all blend shape poses in the scene.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_dialog</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">confirmDialog</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export and Save Pose?&#39;</span><span class="p">,</span>
                                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Export all blend shapes?&#39;</span><span class="p">,</span>
                                        <span class="n">button</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
                                        <span class="n">defaultButton</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span>
                                        <span class="n">cancelButton</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">,</span>
                                        <span class="n">dismissString</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">region_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">regions_list</span>
        <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">region_list</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;regions&#39;</span><span class="p">][</span><span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mesh_category&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">category</span> <span class="ow">and</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;blendshape_mesh&#39;</span><span class="p">:</span>
                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
            <span class="n">face_import_export</span><span class="o">.</span><span class="n">export_all_blendshapes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;All Blend Shapes Exported&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

<div class="viewcode-block" id="FaceStagingUI.import_skeleton"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.import_skeleton">[docs]</a>    <span class="k">def</span> <span class="nf">import_skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Imports .skl skeleton.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cpg_asset</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

        <span class="n">skel_path</span> <span class="o">=</span> <span class="n">cpg_asset</span><span class="o">.</span><span class="n">skel_path</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">skel_path</span><span class="p">)):</span>
            <span class="n">skel</span> <span class="o">=</span> <span class="n">skel_utils</span><span class="o">.</span><span class="n">import_skeleton</span><span class="p">(</span><span class="n">skel_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">skel_path</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_common_face_skeletons</span><span class="p">()</span>
            <span class="n">skel_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">skel_path</span><span class="p">,</span> <span class="s1">&#39;human_face_skeleton.skl&#39;</span><span class="p">)</span>
            <span class="n">skel</span> <span class="o">=</span> <span class="n">skel_utils</span><span class="o">.</span><span class="n">import_skeleton</span><span class="p">(</span><span class="n">skel_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skel</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No skeleton file exists to import&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">skel</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()]</span>
        <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">drawStyle</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">hasAttr</span><span class="p">(</span><span class="s1">&#39;chainEnd&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">chainEnd</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;neck&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skeleton"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skeleton">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the .skl skeleton to the asset location.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export Skeleton?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Export Skeleton?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">multipleFilters</span> <span class="o">=</span> <span class="s2">&quot;Maya ASCII (*.skl)&quot;</span>
        <span class="n">asset_dir</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_asset_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

        <span class="n">export_path</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">fileDialog2</span><span class="p">(</span><span class="n">fileFilter</span><span class="o">=</span><span class="n">multipleFilters</span><span class="p">,</span> <span class="n">dialogStyle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">asset_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">export_path</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">export_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">skel_utils</span><span class="o">.</span><span class="n">export_skeleton</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skin_meshes_as_ma"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skin_meshes_as_ma">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_skin_meshes_as_ma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the skinned meshes as .ma</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">export_skinned_meshes</span><span class="p">(</span><span class="n">fbx_export</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skin_meshes_as_fbx"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skin_meshes_as_fbx">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_skin_meshes_as_fbx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the skinned meshes as fbx</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">export_skinned_meshes</span><span class="p">(</span><span class="n">fbx_export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skinned_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skinned_meshes">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="nd">@ma_decorators</span><span class="o">.</span><span class="n">keep_selection_decorator</span>
    <span class="k">def</span> <span class="nf">export_skinned_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fbx_export</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the skinned meshes.</span>

<span class="sd">        :param bool fbx_export: if True, the meshes will be exported as an FBX.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">fbx_export</span><span class="p">:</span>
            <span class="n">multipleFilters</span> <span class="o">=</span> <span class="s2">&quot;Fbx (*.fbx;*.FBX)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">multipleFilters</span> <span class="o">=</span> <span class="s2">&quot;Maya ASCII (*.ma)&quot;</span>

        <span class="n">asset_dir</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_asset_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

        <span class="n">export_path</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">fileDialog2</span><span class="p">(</span><span class="n">fileFilter</span><span class="o">=</span><span class="n">multipleFilters</span><span class="p">,</span> <span class="n">dialogStyle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">asset_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">export_path</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">export_path</span> <span class="o">=</span> <span class="n">export_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">temp_meshes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="n">dup_mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">duplicate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">dup_mesh</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dup_mesh</span><span class="p">)</span>
            <span class="n">dup_mesh</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh</span><span class="p">))</span>
            <span class="n">dup_mesh</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">display_layers</span><span class="o">.</span><span class="n">remove_objects_from_layers</span><span class="p">(</span><span class="n">temp_meshes</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">temp_meshes</span><span class="p">)</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">rename</span><span class="o">=</span><span class="n">export_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fbx_export</span><span class="p">:</span>
                <span class="n">fbx_utils</span><span class="o">.</span><span class="n">export_fbx</span><span class="p">(</span><span class="n">fbx_path</span><span class="o">=</span><span class="n">export_path</span><span class="p">,</span> <span class="n">node_list</span><span class="o">=</span><span class="n">temp_meshes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmds</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exportSelected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;mayaAscii&quot;</span><span class="p">,</span> <span class="n">mergeNamespaceWithRoot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Success!</span><span class="se">\n</span><span class="s1">Meshes were exported.</span><span class="se">\n\n</span><span class="si">{</span><span class="n">export_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">temp_meshes</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Meshes Exported Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.open_common_in_explorer"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.open_common_in_explorer">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">open_common_in_explorer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the face common folder in Windows Explorer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">common_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;CommonModels&#39;</span><span class="p">)</span>
        <span class="n">common_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">common_directory</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;explorer &#39;</span> <span class="o">+</span> <span class="n">common_directory</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="FaceStagingUI.open_asset_location_in_explorer"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.open_asset_location_in_explorer">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">open_asset_location_in_explorer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the asset folder in Windows Explorer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">asset_directory</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_asset_path</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">full_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">asset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">asset_directory</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;explorer &#39;</span> <span class="o">+</span> <span class="n">asset_directory</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="FaceStagingUI.import_from_common"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.import_from_common">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">import_from_common</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Imports .ma files from starting from the common file directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">multiple_filters</span> <span class="o">=</span> <span class="s2">&quot;Maya Files (*.ma *.mb);;Maya ASCII (*.ma);;Maya Binary (*.mb);;All Files (*.*)&quot;</span>
        <span class="n">starting_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;CommonModels&#39;</span><span class="p">)</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">fileDialog2</span><span class="p">(</span><span class="n">fileFilter</span><span class="o">=</span><span class="n">multiple_filters</span><span class="p">,</span>
                                    <span class="n">dialogStyle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">dir</span><span class="o">=</span><span class="n">starting_directory</span><span class="p">,</span>
                                    <span class="n">fm</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filepath</span><span class="p">:</span>
            <span class="p">[</span><span class="n">pm</span><span class="o">.</span><span class="n">importFile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">filepath</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.import_from_asset_location"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.import_from_asset_location">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">import_from_asset_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Imports .ma files from starting from the asset file directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">multiple_filters</span> <span class="o">=</span> <span class="s2">&quot;Maya Files (*.ma *.mb);;Maya ASCII (*.ma);;Maya Binary (*.mb);;All Files (*.*)&quot;</span>
        <span class="n">starting_directory</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_asset_path</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">full_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">fileDialog2</span><span class="p">(</span><span class="n">fileFilter</span><span class="o">=</span><span class="n">multiple_filters</span><span class="p">,</span>
                                    <span class="n">dialogStyle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">dir</span><span class="o">=</span><span class="n">starting_directory</span><span class="p">,</span>
                                    <span class="n">fm</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filepath</span><span class="p">:</span>
            <span class="p">[</span><span class="n">pm</span><span class="o">.</span><span class="n">importFile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">filepath</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.create_pose_file"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.create_pose_file">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">create_pose_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pose_files</span><span class="o">.</span><span class="n">create_face_pose_file</span><span class="p">(</span><span class="n">create_skeleton</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skeletal_mesh"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skeletal_mesh">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_skeletal_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports head SK</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="n">frag_root</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_frag_root_by_assetid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">root_joint</span> <span class="o">=</span> <span class="n">frag_root</span><span class="o">.</span><span class="n">rootJoint</span><span class="o">.</span><span class="n">listConnections</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sk_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asset_sk_name_path</span><span class="p">()</span>

        <span class="n">face_util</span><span class="o">.</span><span class="n">export_head_sk</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="n">root_joint</span><span class="p">,</span> <span class="n">sk_path</span><span class="p">)</span>

        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;SK Export Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_pose_file"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_pose_file">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_pose_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports a duplicate skeleton file with the poses bake.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">confirmDialog</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export Pose File?&#39;</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="s1">&#39;Export the animated pose file?&#39;</span><span class="p">,</span>
                                    <span class="n">button</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
                                    <span class="n">defaultButton</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span>
                                    <span class="n">cancelButton</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">,</span>
                                    <span class="n">dismissString</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">multiple_filters</span> <span class="o">=</span> <span class="s2">&quot;Fbx (*.fbx;*.FBX);;All Files (*.*)&quot;</span>
        <span class="n">asset_directory</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_asset_path</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">full_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">asset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">asset_directory</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">fileDialog2</span><span class="p">(</span><span class="n">fileFilter</span><span class="o">=</span><span class="n">multiple_filters</span><span class="p">,</span>
                                    <span class="n">dialogStyle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">dir</span><span class="o">=</span><span class="n">asset_directory</span><span class="p">,</span>
                                    <span class="n">fm</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">pose_files</span><span class="o">.</span><span class="n">export_face_pose_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pose File Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.import_model_file"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.import_model_file">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">import_model_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Imports the model file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Open model file?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Open model file?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">newFile</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sm_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asset_sm_name_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sm_path</span><span class="p">):</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;File Doesn&#39;t Exist&quot;</span><span class="p">,</span>
                                    <span class="n">text</span><span class="o">=</span><span class="s1">&#39;The SM FBX File does not exist or is not named correctly.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                    <span class="sa">f</span><span class="s1">&#39;The name should be:</span><span class="se">\n</span><span class="si">{</span><span class="n">sm_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">imported_objs</span> <span class="o">=</span> <span class="n">fbx_utils</span><span class="o">.</span><span class="n">import_fbx</span><span class="p">(</span><span class="n">sm_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">imported_objs</span><span class="p">:</span>
            <span class="n">imported_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">imported_objs</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">nt</span><span class="o">.</span><span class="n">Transform</span><span class="p">)]</span>
            <span class="n">face_util</span><span class="o">.</span><span class="n">face_scene_setup</span><span class="p">(</span><span class="n">imported_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ui_on_open</span><span class="p">()</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Model File Imported Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_source_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_source_meshes">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_source_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the source meshes and creates a new source rig.\</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export Source Files?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Export Source Files?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">face_component</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Need A Rig&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Need to be in a rig file.</span><span class="se">\n</span><span class="s1">No Face Mesh Component or Rig found.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">blendshape_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_blendshape_meshes</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">blendshape_meshes</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Blend Shapes Meshes&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="s1">&#39;No blend shapes meshes found.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">save_source_data</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cpg_asset</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">asset_name</span> <span class="o">=</span> <span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span>
        <span class="n">face_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;SourceHeads&#39;</span><span class="p">,</span> <span class="n">asset_name</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">face_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">source_data</span><span class="o">.</span><span class="n">FACE_FILE_NAME</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">save_source_data</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Re-Save Face Data?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;The source text files already exist.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                                <span class="s1">&#39;Re-Export Source Data Files?</span><span class="se">\n</span><span class="s1">&#39;</span>
                                                <span class="s1">&#39;This is not the Meshes!</span><span class="se">\n</span><span class="s1">This is the text data associated with &#39;</span>
                                                <span class="s1">&#39;the mesh file.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
                <span class="n">save_source_data</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">source_list</span> <span class="o">=</span> <span class="n">source_meshes</span><span class="o">.</span><span class="n">convert_all_to_source_mesh</span><span class="p">(</span><span class="n">mesh_list</span><span class="o">=</span><span class="n">blendshape_meshes</span><span class="p">,</span>
                                                                <span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span>
                                                                <span class="n">mesh_component</span><span class="o">=</span><span class="n">face_component</span><span class="o">.</span><span class="n">pynode</span><span class="p">)</span>

        <span class="n">source_meshes</span><span class="o">.</span><span class="n">export_source_shapes</span><span class="p">(</span><span class="n">source_list</span><span class="o">=</span><span class="n">source_list</span><span class="p">,</span>
                                            <span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span>
                                            <span class="n">save_source_data</span><span class="o">=</span><span class="n">save_source_data</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Source Meshes Exported Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

    <span class="c1">####################</span>
    <span class="c1"># Side Toolbar</span>
    <span class="c1">####################</span>
<div class="viewcode-block" id="FaceStagingUI.get_rigs"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_rigs">[docs]</a>    <span class="k">def</span> <span class="nf">get_rigs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all the frag rigs in the scene.</span>

<span class="sd">        :return: Returns a list of all the frag rigs in the scene.</span>
<span class="sd">        :rtype: list(FRAGRig)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">all_roots</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_all_frag_roots</span><span class="p">()</span>
        <span class="n">all_frag_rigs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get_rig</span><span class="p">(),</span> <span class="n">all_roots</span><span class="p">))</span>
        <span class="n">all_frag_rigs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_frag_rigs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_frag_rigs</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_rig"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_rig">[docs]</a>    <span class="k">def</span> <span class="nf">get_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the frag by the asset ID.</span>

<span class="sd">        :return: Returns the frag by the asset ID.</span>
<span class="sd">        :rtype: FRAGRig</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_root</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_frag_root_by_assetid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_root</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">frag_root</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_pose_grp"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_pose_grp">[docs]</a>    <span class="k">def</span> <span class="nf">get_pose_grp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the pose grp.  The grp that the blend shapes are under.</span>

<span class="sd">        :return: Returns the pose grp.  The grp that the blend shapes are under.</span>
<span class="sd">        :rtype: pm.nt.Transform</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="s1">&#39;facePoseGrp&#39;</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There is no pose group attached to the </span><span class="si">{</span><span class="n">frag_rig</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="n">pose_grp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">node</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pm</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;*.isPoseGrp&#39;</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">o</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">nt</span><span class="o">.</span><span class="n">Transform</span><span class="p">)]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_grp</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot find the pose group in the scene!&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pose_grp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">facePoseGrp</span><span class="o">.</span><span class="n">get</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_parameter_node"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_parameter_node">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameter_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the FRAG parameters node.</span>

<span class="sd">        :return: Returns the FRAG parameters node.</span>
<span class="sd">        :rtype: FragFaceParameters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">parameter_node</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">get_frag_children</span><span class="p">(</span><span class="n">of_type</span><span class="o">=</span><span class="n">frag</span><span class="o">.</span><span class="n">FragFaceParameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parameter_node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">parameter_node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_face_component"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_face_component">[docs]</a>    <span class="k">def</span> <span class="nf">get_face_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the FRAG face mesh component.</span>

<span class="sd">        :return: Returns the FRAG face mesh component.</span>
<span class="sd">        :rtype: FaceMeshComponent</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_root</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_frag_root_by_assetid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_root</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">skeletal_mesh</span> <span class="o">=</span> <span class="n">frag_root</span><span class="o">.</span><span class="n">get_skeletal_mesh</span><span class="p">()</span>
        <span class="n">face_components</span> <span class="o">=</span> <span class="n">skeletal_mesh</span><span class="o">.</span><span class="n">get_frag_children</span><span class="p">(</span><span class="n">of_type</span><span class="o">=</span><span class="n">frag</span><span class="o">.</span><span class="n">FaceMeshComponent</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">face_components</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_component</span> <span class="o">=</span> <span class="n">face_components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_component</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_all_skinned_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_all_skinned_meshes">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_skinned_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of meshes that get skinned.</span>

<span class="sd">        :return: Returns a list of meshes that get skinned.</span>
<span class="sd">        :rtype: list(pm.nt.Transform)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">face_component</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">skinned_meshes</span> <span class="o">=</span> <span class="n">face_component</span><span class="o">.</span><span class="n">get_all_category_meshes</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">FACE_SKINNED_CATEGORY</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">skinned_meshes</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_all_blendshape_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_all_blendshape_meshes">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_blendshape_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of meshes that are blend shapes.</span>

<span class="sd">        :return: Returns a list of meshes that are blend shapes.</span>
<span class="sd">        :rtype: list(pm.nt.Transform)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">face_component</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">blendshape_meshes</span> <span class="o">=</span> <span class="n">face_component</span><span class="o">.</span><span class="n">get_all_category_meshes</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">FACE_BLENDSHAPE_CATEGORY</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blendshape_meshes</span></div>

<div class="viewcode-block" id="FaceStagingUI.eyelash_snap"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.eyelash_snap">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">eyelash_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Snaps eyelash/shadow/tear to head mesh based on UV coordinates for asset ID</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eyelash_snapping</span><span class="o">.</span><span class="n">eyelash_snap_action</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.calibration_animation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.calibration_animation">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">calibration_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an animation to the rig scene</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">get_flags</span><span class="p">()</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;Animations&#39;</span><span class="p">,</span> <span class="s1">&#39;face_calibration.ma&#39;</span><span class="p">)</span>
        <span class="n">anim_curves_component</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">AnimatedCurvesComponent</span><span class="o">.</span><span class="n">import_animated_curve_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">anim_curves_component</span><span class="o">.</span><span class="n">restore_all_animation_curves</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">playbackOptions</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="n">anim_curves_component</span><span class="o">.</span><span class="n">startFrame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="nb">max</span><span class="o">=</span><span class="n">anim_curves_component</span><span class="o">.</span><span class="n">endFrame</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">anim_curves_component</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Animation Applied Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.cut_animation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.cut_animation">[docs]</a>    <span class="k">def</span> <span class="nf">cut_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the animation from the rig.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">flag_utils</span><span class="o">.</span><span class="n">cut_all_flag_animations</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Animation Cut Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.save_calibration_animation"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.save_calibration_animation">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">save_calibration_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves an animation to a file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Save Animation?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Overwrite the Calibration Animation?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">get_flags</span><span class="p">()</span>

        <span class="n">anim_curves_component</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">AnimatedCurvesComponent</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">anim_curves_component</span><span class="o">.</span><span class="n">store_all_animation_curves</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;Animations&#39;</span><span class="p">,</span> <span class="s1">&#39;face_calibration.ma&#39;</span><span class="p">)</span>
        <span class="n">anim_curves_component</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">anim_curves_component</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Animation Saved Successfully!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.zero_flags"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.zero_flags">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">zero_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zeros out the flags.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selection</span><span class="p">:</span>
            <span class="n">flag_utils</span><span class="o">.</span><span class="n">zero_flags</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_start_ups</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">all_frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
        <span class="n">flag_utils</span><span class="o">.</span><span class="n">zero_flags</span><span class="p">(</span><span class="n">all_frag_rigs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_start_ups</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.flags_visibility"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.flags_visibility">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">flags_visibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the flags to invisible using the layers.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selection</span><span class="p">:</span>
            <span class="n">flag_utils</span><span class="o">.</span><span class="n">flags_visibility</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">all_frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
        <span class="n">flag_utils</span><span class="o">.</span><span class="n">flags_visibility</span><span class="p">(</span><span class="n">all_frag_rigs</span><span class="p">,</span> <span class="n">toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.refreshUI"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.refreshUI">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">refreshUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refreshes the UI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">FaceStagingUI</span><span class="p">()</span></div>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">_mirror_selected_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mirrors selected vertices.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selected</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">sl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Select Vertices&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please select the vertices you wish to mirror&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">o</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Cannot mirror.  The mesh does not have any markup.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">region_data</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_face_region_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>

        <span class="n">mirror_data</span> <span class="o">=</span> <span class="n">region_data</span><span class="o">.</span><span class="n">get_mirror_data</span><span class="p">()</span>
        <span class="n">mirror_data</span><span class="o">.</span><span class="n">mirror_vertices</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<div class="viewcode-block" id="FaceStagingUI.save_blendshape_rig"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.save_blendshape_rig">[docs]</a>    <span class="k">def</span> <span class="nf">save_blendshape_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">just_rename</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the scene as the blend shape rig scene.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cpg_asset</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">scene_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">rigs_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s1">_blendshape_rig.ma&#39;</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">rename</span><span class="o">=</span><span class="n">scene_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">just_rename</span><span class="p">:</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;mayaAscii&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.register_new_head"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.register_new_head">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">register_new_head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens asset register tool UI and pre-sets category to head.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">asset_reg_tool</span> <span class="o">=</span> <span class="n">ma_asset_register</span><span class="o">.</span><span class="n">MayaAssetRegister</span><span class="p">()</span>
        <span class="n">asset_reg_tool</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">categoryBox</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)</span>
        <span class="n">asset_reg_tool</span><span class="o">.</span><span class="n">on_new_button_pressed</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.open_skinning_tools"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.open_skinning_tools">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">open_skinning_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens face skinning tools UI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">face_skinning_tool</span><span class="o">.</span><span class="n">FaceSkinning</span><span class="p">()</span></div>

    <span class="c1">####################</span>
    <span class="c1"># Asset ID</span>
    <span class="c1">####################</span>
    <span class="k">def</span> <span class="nf">_asset_id_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates ui data based on the current asset id change.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asset_id_from_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_source_face_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_common_face_data</span><span class="p">()</span>

        <span class="n">skinned_regions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">skinned_regions_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_regions</span><span class="p">(</span><span class="n">skinned_regions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_asset_id_selection_optionvars</span><span class="p">()</span>

    <span class="c1">####################</span>
    <span class="c1"># Mesh Info</span>
    <span class="c1">####################</span>
    <span class="k">def</span> <span class="nf">_populate_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regions_list</span><span class="p">,</span> <span class="n">selected_region</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates a QlistWidget with the names of the regions.</span>

<span class="sd">        :param list(str) regions_list: A list of regions.  Region is the top level name for the mesh data.</span>
<span class="sd">        :param str selected_region: A region name</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">regions_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_region</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="o">.</span><span class="n">setCurrentRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">listwidget_utils</span><span class="o">.</span><span class="n">get_qlist_widget_selected_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Update the self.region_data, head_blendshape, head_mesh, eye_left_mesh, etc...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_face_region_data</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate_tagged_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates a QlistWidget with the names tagged meshes.  These meshes are associated with the region data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the region</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">listwidget_utils</span><span class="o">.</span><span class="n">get_qlist_widget_selected_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">region</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># Get all the meshes in the scene with markup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_markup</span> <span class="o">=</span> <span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">RigMeshMarkup</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_markup</span><span class="o">.</span><span class="n">get_mesh_list_in_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">as_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">[</span><span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
        <span class="c1">#self.ui.tagged_listWidget.addItems(items)</span>
        <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="o">.</span><span class="n">setCurrentRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="FaceStagingUI.select_tagged_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.select_tagged_meshes">[docs]</a>    <span class="k">def</span> <span class="nf">select_tagged_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects a mesh in a QList Widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">select_item_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_markup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">meshes</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="n">usable_meshes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="n">mesh_children</span> <span class="o">=</span> <span class="n">lists</span><span class="o">.</span><span class="n">get_first_in_list</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">listRelatives</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh_children</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">nt</span><span class="o">.</span><span class="n">Mesh</span><span class="p">):</span>
                <span class="n">usable_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">usable_meshes</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Mesh Usable Meshes Selected&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Select a mesh and try again&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">region</span> <span class="o">=</span> <span class="n">listwidget_utils</span><span class="o">.</span><span class="n">get_qlist_widget_selected_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">regions_listWidget</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Update the self.region_data, head_blendshape, head_mesh, eye_left_mesh, etc...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_face_region_data</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="c1">#markups = self.region_data.get_mesh_dict()</span>
        <span class="n">q_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">)</span>
        <span class="n">meshes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">usable_meshes</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">q_items</span><span class="p">]</span>
        <span class="c1">#self.ui.tagged_listWidget.addItems(meshes)</span>
        <span class="p">[</span><span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">]</span>

        <span class="c1"># Adds the markup</span>
        <span class="k">if</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="n">type_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="o">.</span><span class="n">mesh_type_name</span>
            <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="o">.</span><span class="n">mesh_category</span>
            <span class="n">side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="o">.</span><span class="n">side</span>
            <span class="n">mirror_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="o">.</span><span class="n">mirror_type</span>
            <span class="n">source_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="o">.</span><span class="n">source_head</span>
            <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
                <span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">MeshMarkup</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span>
                                                    <span class="n">type_name</span><span class="o">=</span><span class="n">type_name</span><span class="p">,</span>
                                                    <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
                                                    <span class="n">side</span><span class="o">=</span><span class="n">side</span><span class="p">,</span>
                                                    <span class="n">mirror_type</span><span class="o">=</span><span class="n">mirror_type</span><span class="p">,</span>
                                                    <span class="n">source_head</span><span class="o">=</span><span class="n">source_head</span><span class="p">,</span>
                                                    <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_remove_markup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the attributes that has the mesh data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selected_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_meshes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Remove the mesh markup?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Remove the mesh markup?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="p">[</span><span class="n">cmds</span><span class="o">.</span><span class="n">deleteAttr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">CPG_MESH_MARKUP</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">selected_meshes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tagged_meshes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_select_marked_up_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects meshes that are in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_qwidget_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tagged_listWidget</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_blendshape_edit_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects meshes that are in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_qwidget_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_skinned_edit_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects meshes that are in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_qwidget_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_list_listWidget</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_pose_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects meshes that are in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_qwidget_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_qwidget_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qlist_widget</span><span class="p">):</span>
        <span class="n">selected_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="n">qlist_widget</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selected_meshes</span><span class="p">:</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">selected_meshes</span><span class="p">)</span>

    <span class="c1">###############################</span>
    <span class="c1"># Create Rig</span>
    <span class="c1">###############################</span>
    <span class="k">def</span> <span class="nf">_create_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_head_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the Rig template and creates the blend shape rig.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cpg_asset</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

        <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">rig_template</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">template</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span><span class="si">}</span><span class="s1">: Rig does not have a rig template set in the source data.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_dialog</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Create Head Rig?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Do you wish to build the Head Rig?&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="n">mesh_check</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_all_scene_face_meshes</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh_check</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No tagged face mesh found in scene.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">import_skeleton</span><span class="p">()</span>
        <span class="c1"># import the template module</span>
        <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;from </span><span class="si">{</span><span class="n">TEMPLATES_PATH</span><span class="si">}</span><span class="s1"> import </span><span class="si">{</span><span class="n">template</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Execute the Rig Template</span>
        <span class="n">head_template</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">template</span><span class="si">}</span><span class="s1">()&#39;</span><span class="p">)</span>
        <span class="c1"># Make sure the asset id is correct.</span>
        <span class="n">head_template</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span>
        <span class="k">if</span> <span class="n">source_head_name</span><span class="p">:</span>
            <span class="n">head_template</span><span class="o">.</span><span class="n">source_head_name</span> <span class="o">=</span> <span class="n">source_head_name</span>
            <span class="n">head_template</span><span class="o">.</span><span class="n">generate_shapes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">head_template</span><span class="o">.</span><span class="n">rig</span><span class="p">()</span>

        <span class="c1"># populate listWidgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_start_ups</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_blendshape_scene_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_blendshape_rig</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_blendshape_rig</span><span class="p">(</span><span class="n">just_rename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">face_component</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">head_mesh</span> <span class="o">=</span> <span class="n">face_component</span><span class="o">.</span><span class="n">head_blendshape</span>
        <span class="n">parameter_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_node</span><span class="p">()</span>
        <span class="n">face_util</span><span class="o">.</span><span class="n">face_scene_setup</span><span class="p">(</span><span class="n">focus_object</span><span class="o">=</span><span class="n">head_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">rig_node</span><span class="o">=</span><span class="n">parameter_node</span><span class="o">.</span><span class="n">pynode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">source_head_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_source_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">source_head_name</span><span class="p">:</span>
                <span class="n">source_head_name</span> <span class="o">=</span> <span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span>
            <span class="n">source_meshes</span><span class="o">.</span><span class="n">connect_source_meshes_to_rig</span><span class="p">(</span><span class="n">source_head_name</span><span class="p">,</span> <span class="n">parameter_node</span><span class="p">)</span>

        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Rig Build Complete&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">_create_rig_existing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the rig with existing blend shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_rig</span><span class="p">()</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Blend shapes were imported successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">_create_rig_generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the rig and generates new blend shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cpg_asset</span> <span class="o">=</span> <span class="n">assetlist</span><span class="o">.</span><span class="n">get_asset_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Create Head Rig?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Do you wish to build a new head rig for &#39;</span>
                                                                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span><span class="si">}</span><span class="s1">?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">asset_directory</span> <span class="o">=</span> <span class="n">cpg_asset</span><span class="o">.</span><span class="n">general_path</span>
        <span class="n">source_name</span> <span class="o">=</span> <span class="n">cpg_asset</span><span class="o">.</span><span class="n">asset_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_rig</span><span class="p">(</span><span class="n">source_name</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">create_flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_flags_from_common</span><span class="p">()</span>

        <span class="n">skel_utils</span><span class="o">.</span><span class="n">export_skeleton</span><span class="p">(</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">skel_path</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">))</span>
        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">generate_process_skinning_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_meshes_process_skinning</span><span class="p">(</span><span class="n">skip_dialog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fileio</span><span class="o">.</span><span class="n">touch_path</span><span class="p">(</span><span class="n">cpg_asset</span><span class="o">.</span><span class="n">skin_data_path</span><span class="p">)</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">face_skinning</span><span class="o">.</span><span class="n">export_face_skinning_to_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">meshes</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_shapes_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_export_all_blendshapes</span><span class="p">(</span><span class="n">skip_dialog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_sk_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">unskinned_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">meshes</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">skin_utils</span><span class="o">.</span><span class="n">get_skin_cluster_from_geometry</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">unskinned_list</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;These meshes were not skinned: </span><span class="si">{</span><span class="n">unskinned_list</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">export_skeletal_mesh</span><span class="p">()</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">asset_directory</span><span class="p">,</span> <span class="s1">&#39;Animations&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">pose_files</span><span class="o">.</span><span class="n">export_face_pose_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cut_animation</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_rig_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">face_util</span><span class="o">.</span><span class="n">clean_and_save_face_rig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Blend shapes were generated successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span>
                                     <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">e</span><span class="o">-</span><span class="n">s</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rig built in </span><span class="si">{</span><span class="n">x</span><span class="o">/</span><span class="mi">60</span><span class="si">}</span><span class="s1"> minutes&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_open_model_build_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">model_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">import_model_file</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model_file</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_rig</span><span class="p">(</span><span class="n">skip_dialog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Blend shapes were imported successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">####################################</span>
    <span class="c1"># Vertex Snapping Tools</span>
    <span class="c1">####################################</span>
<div class="viewcode-block" id="FaceStagingUI.switch_vertex_snapping_icon"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.switch_vertex_snapping_icon">[docs]</a>    <span class="k">def</span> <span class="nf">switch_vertex_snapping_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">expand_snapping_tools_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;expand&#39;</span><span class="p">)</span>
        <span class="n">collapse_snapping_tools_icon</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;collapse&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertex_snapping_frame</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">expand_snapping_tools_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">expand_snapping_tools_icon</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">expand_snapping_tools_pushButton</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">collapse_snapping_tools_icon</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_on_expand_snapping_tools_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertex_snapping_frame</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_vertex_snapping_icon</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snappable_regions_comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertex_snapping_frame</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_vertex_snapping_icon</span><span class="p">()</span>
            <span class="n">snappable_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lips&#39;</span><span class="p">,</span> <span class="s1">&#39;Right Eyelid&#39;</span><span class="p">,</span> <span class="s1">&#39;Left Eyelid&#39;</span><span class="p">]</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snappable_regions_comboBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">snappable_items</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertex_snapping_frame</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_on_bottom_to_top_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Snaps verts in selected region from bottom to top.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">smooth_mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">smooth_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_horizontalSlider</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="n">common_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;rig_source_data.json&#39;</span><span class="p">)</span>
        <span class="n">vertex_snap_data</span> <span class="o">=</span> <span class="n">face_vertex_data</span><span class="o">.</span><span class="n">SourceFaceEyelashShelf</span><span class="o">.</span><span class="n">load_vertex_data</span><span class="p">(</span><span class="n">common_data_path</span><span class="p">,</span> <span class="s1">&#39;head_blendshape&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snappable_regions_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">head</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Please first select head mesh&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">naming</span><span class="o">.</span><span class="n">get_basename</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Lips&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_lips_bottom_to_top</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Right Eyelid&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_side_bottom_blink</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_side_bottom_blink</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_top_to_bottom_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Snaps verts in selected region from top to bottom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">smooth_mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">smooth_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_horizontalSlider</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="n">common_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;rig_source_data.json&#39;</span><span class="p">)</span>
        <span class="n">vertex_snap_data</span> <span class="o">=</span> <span class="n">face_vertex_data</span><span class="o">.</span><span class="n">SourceFaceEyelashShelf</span><span class="o">.</span><span class="n">load_vertex_data</span><span class="p">(</span><span class="n">common_data_path</span><span class="p">,</span> <span class="s1">&#39;head_blendshape&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snappable_regions_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">head</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Please first select head mesh&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">naming</span><span class="o">.</span><span class="n">get_basename</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Lips&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_lips_top_to_bottom</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Right Eyelid&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_side_top_blink</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_side_top_blink</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_meet_at_middle_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Snaps verts in selected region to midpoint between top and bottom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">smooth_mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">smooth_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snap_smoothing_horizontalSlider</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">common_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;rig_source_data.json&#39;</span><span class="p">)</span>
        <span class="n">vertex_snap_data</span> <span class="o">=</span> <span class="n">face_vertex_data</span><span class="o">.</span><span class="n">SourceFaceEyelashShelf</span><span class="o">.</span><span class="n">load_vertex_data</span><span class="p">(</span><span class="n">common_data_path</span><span class="p">,</span> <span class="s1">&#39;head_blendshape&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">snappable_regions_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">head</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Please first select head mesh&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">naming</span><span class="o">.</span><span class="n">get_basename</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Lips&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_lips_to_middle</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;Right Eyelid&#39;</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_eye_blink_to_middle</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vertex_snap_data</span><span class="o">.</span><span class="n">snap_eye_blink_to_middle</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth_mesh</span><span class="p">,</span> <span class="n">smooth_amount</span><span class="o">=</span><span class="n">smooth_amount</span><span class="p">)</span>
    <span class="c1">####################################</span>
    <span class="c1"># Edit Tools - Auto Edit</span>
    <span class="c1">####################################</span>
    <span class="k">def</span> <span class="nf">_set_local_axis_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the local axis display on the face joints.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
        <span class="c1">#Return all the frag rigs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rigs</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Get the root joint</span>
        <span class="n">frag_rig</span> <span class="o">=</span> <span class="n">frag_rigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">root_joint</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_root_joint</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root_joint</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Get all the pose joints</span>
        <span class="n">root_joint</span><span class="o">.</span><span class="n">listRelatives</span><span class="p">(</span><span class="n">ad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">all_joints</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">root_joint</span><span class="o">.</span><span class="n">listRelatives</span><span class="p">(</span><span class="n">ad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">nt</span><span class="o">.</span><span class="n">Joint</span><span class="p">)]</span>
        <span class="n">joints</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_joints</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">hasAttr</span><span class="p">(</span><span class="s1">&#39;isPoseJoint&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">isPoseJoint</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">joints</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Set the local axis display on or off depending on what state the 1st joint is in.</span>
        <span class="n">state</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">displayLocalAxis</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">displayLocalAxis</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">hasAttr</span><span class="p">(</span><span class="s1">&#39;displayLocalAxis&#39;</span><span class="p">)]</span>

    <span class="c1">####################################</span>
    <span class="c1"># Edit Tools - Poses</span>
    <span class="c1">####################################</span>
    <span class="k">def</span> <span class="nf">_populate_blendshape_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the blend shape names in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">RigMeshMarkup</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="n">blendshape_meshes</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="n">get_mesh_list_in_category</span><span class="p">(</span><span class="s1">&#39;blendshape_mesh&#39;</span><span class="p">,</span> <span class="n">as_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">blendshape_meshes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="p">[</span><span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">blendshape_meshes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">setCurrentRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate_skin_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the names of the meshes that get skinned in a QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_list_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">skin_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skin_meshes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">skin_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">skin_meshes</span><span class="p">))</span>
        <span class="p">[</span><span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_list_listWidget</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREY</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skin_meshes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">skin_list_listWidget</span><span class="o">.</span><span class="n">setCurrentRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate_edit_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the blend shape and skin mesh QListWidgets:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_blendshape_meshes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_skin_meshes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate_poses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the names of poses that have been activated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Clear List widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_percent_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Check to see if the blend shape mesh has that pose.</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pm</span><span class="o">.</span><span class="n">objExists</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">parameters_inst</span> <span class="o">=</span> <span class="n">face_util</span><span class="o">.</span><span class="n">get_parameters_region_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
        <span class="n">parameter_list</span> <span class="o">=</span> <span class="n">parameters_inst</span><span class="o">.</span><span class="n">get_parameters_list</span><span class="p">()</span>
        <span class="n">pose_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">connection</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parameter_list</span><span class="p">]</span>

        <span class="c1"># Grab the parameter node and get the poses and the values</span>
        <span class="n">parameter_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_node</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parameter_node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">pose_dict</span> <span class="o">=</span> <span class="n">parameter_node</span><span class="o">.</span><span class="n">get_all_active_poses_and_value</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_dict</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">full_active</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">part_active</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">pose_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">:</span>
                <span class="n">part_active</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span><span class="n">values</span><span class="p">})</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">:</span>
                <span class="n">full_active</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>

        <span class="k">for</span> <span class="n">pose_name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">full_active</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">percent_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">pose_flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;flag&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_percent_listWidget</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">percent_value</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="p">,</span> <span class="n">pose_flag</span><span class="p">,</span> <span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pose_name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">part_active</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">percent_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">pose_flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;flag&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_RED</span><span class="p">)</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_percent_listWidget</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">percent_value</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">STAGING_COLOR_RED</span><span class="p">)</span>
            <span class="n">QLabelTextQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="p">,</span> <span class="n">pose_flag</span><span class="p">,</span> <span class="n">STAGING_COLOR_RED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">setCurrentRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="FaceStagingUI.mirror_pose_from_listwidget"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.mirror_pose_from_listwidget">[docs]</a>    <span class="k">def</span> <span class="nf">mirror_pose_from_listwidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">blendshape_mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="n">pose_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pose_from_listwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_name</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Pose Selected&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please Select a pose from the pose list and try again&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">cmds</span><span class="o">.</span><span class="n">objExists</span><span class="p">(</span><span class="n">pose_name</span><span class="p">):</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mesh Does Not Exist&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;The mesh, &quot;</span><span class="si">{</span><span class="n">pose_name</span><span class="si">}</span><span class="s1">&quot; does not exist in the scene.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="sa">f</span><span class="s1">&#39;Please import all poses first.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mirror Pose?&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Do you wish mirror </span><span class="si">{</span><span class="n">pose_name</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">blendshape_mesh</span><span class="si">}</span><span class="s1">?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">blendshape_mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">blendshape_mesh</span><span class="p">)</span>
        <span class="n">pose_mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">pose_name</span><span class="p">)</span>
        <span class="n">pose_mesh</span><span class="p">,</span> <span class="n">mirror_mesh</span> <span class="o">=</span> <span class="n">pose_files</span><span class="o">.</span><span class="n">mirror_pose</span><span class="p">(</span><span class="n">pose_mesh</span><span class="o">=</span><span class="n">pose_mesh</span><span class="p">,</span>
                                                <span class="n">mesh</span><span class="o">=</span><span class="n">blendshape_mesh</span><span class="p">,</span>
                                                <span class="n">pose_connection</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span>
                                                <span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mirrored </span><span class="si">{</span><span class="n">pose_mesh</span><span class="si">}</span><span class="s1"> Successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">mirror_mesh</span><span class="p">,</span> <span class="n">pose_mesh</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_export_selected</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_reconnect_shapes_to_rig</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.mirror_all_poses"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.mirror_all_poses">[docs]</a>    <span class="k">def</span> <span class="nf">mirror_all_poses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mirrors left side poses to the right side</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Should come back to this later and make it a user choice of left or right side being mirrored</span>
        <span class="n">side_to_mirror</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>

        <span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_face_data_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">),</span> <span class="s1">&#39;rig_source_data.json&#39;</span><span class="p">)</span>
        <span class="n">source_face_data</span> <span class="o">=</span> <span class="n">source_data</span><span class="o">.</span><span class="n">FaceMeshRegionData</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;head_blendshape&#39;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">source_face_data</span><span class="o">.</span><span class="n">parameters</span>
        <span class="n">poses_to_mirror</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">poses</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">poses</span><span class="p">:</span>
                <span class="n">pose_data</span> <span class="o">=</span> <span class="n">poses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
                <span class="n">pose_side</span> <span class="o">=</span> <span class="n">pose_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;side&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pose_side</span> <span class="o">==</span> <span class="n">side_to_mirror</span><span class="p">:</span>
                    <span class="n">poses_to_mirror</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mirror Pose?&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Do you wish mirror all poses from </span><span class="si">{</span><span class="n">mesh</span><span class="o">.</span><span class="n">mesh</span><span class="si">}</span><span class="s1">?&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">prog_ui</span> <span class="o">=</span> <span class="n">progressbar_ui</span><span class="o">.</span><span class="n">ProgressBarStandard</span><span class="p">()</span>
        <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Starting Up&#39;</span><span class="p">)</span>

        <span class="n">meshes_to_export</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poses_to_mirror</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">pose_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poses_to_mirror</span><span class="p">):</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">i</span>
            <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Mirroring </span><span class="si">{</span><span class="n">pose_name</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
            <span class="n">blendshape_mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>
            <span class="n">pose_mesh</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">pose_name</span><span class="p">)</span>
            <span class="n">pose_mesh</span><span class="p">,</span> <span class="n">mirror_mesh</span> <span class="o">=</span> <span class="n">pose_files</span><span class="o">.</span><span class="n">mirror_pose</span><span class="p">(</span><span class="n">pose_mesh</span><span class="o">=</span><span class="n">pose_mesh</span><span class="p">,</span>
                                                            <span class="n">mesh</span><span class="o">=</span><span class="n">blendshape_mesh</span><span class="p">,</span>
                                                            <span class="n">pose_connection</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span>
                                                            <span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
            <span class="n">meshes_to_export</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose_mesh</span><span class="p">)</span>
            <span class="n">meshes_to_export</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mirror_mesh</span><span class="p">)</span>

        <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;Finished&#39;</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mirrored all </span><span class="si">{</span><span class="n">side_to_mirror</span><span class="si">}</span><span class="s1"> side poses successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">meshes_to_export</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_export_selected</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_reconnect_shapes_to_rig</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_reconnect_shapes_to_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconnects the blend shapes to the rig.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
        <span class="n">blendshape_list</span> <span class="o">=</span> <span class="n">face_component</span><span class="o">.</span><span class="n">get_all_category_meshes</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">FACE_BLENDSHAPE_CATEGORY</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">blendshape</span> <span class="ow">in</span> <span class="n">blendshape_list</span><span class="p">:</span>
            <span class="n">blendshape</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">blendshape</span><span class="p">)</span>
            <span class="n">blendshape</span><span class="o">.</span><span class="n">reconnect_shapes_to_rig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">blendshape</span><span class="o">.</span><span class="n">mesh</span><span class="si">}</span><span class="s1"> Blend Shapes Successfully Reconnected&#39;</span><span class="p">,</span>
                                            <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging&#39;</span><span class="p">,</span>
                                            <span class="n">fade_time</span><span class="o">=</span><span class="mi">170</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_get_pose_from_listwidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name of an active selected pose from a QListWidget.</span>

<span class="sd">        :return: Returns the name of an active selected pose from a QListWidget.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
            <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the percent the pose is active.</span>

<span class="sd">        :return: Returns the percent the pose is active.</span>
<span class="sd">        :rtype: flaot</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">currentRow</span><span class="p">()</span>
        <span class="n">percent_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_percent_listWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">percent_item</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">percent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">percent_item</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">())[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">percent</span>

    <span class="k">def</span> <span class="nf">_get_blendshape_mesh_from_qlistwidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name of a selected mesh from a QListWidget.</span>

<span class="sd">        :return: Returns the name of a selected mesh from a QListWidget.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
            <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">bs_list_listWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_pose_edit_start_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to see if specific data is set before starting a pose edit.</span>

<span class="sd">        :return: Returns a FRAGRig</span>
<span class="sd">        :rtype: FRAGRig</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_percent</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_percent</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">100.0</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pose Not At 100%&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="s1">&#39;The pose needs to be completely set.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="s1">&#39;Please make sure the Flag is set to the max.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rigs</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Rig&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cannot not find the FRAG Rig node.</span><span class="se">\n</span><span class="s1">No rig in the scene.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">frag_rigs</span>
        <span class="k">return</span> <span class="n">frag_rigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_edit_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rigs</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">edit_node</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_face_edit_node</span><span class="p">(</span><span class="n">frag_rigs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">face_pose_edit</span><span class="o">.</span><span class="n">FacePoseEdit</span><span class="p">(</span><span class="n">edit_inst</span><span class="o">=</span><span class="n">edit_node</span><span class="p">)</span>

    <span class="c1">####################################</span>
    <span class="c1"># Edit Tools - Poses edits</span>
    <span class="c1">####################################</span>
    <span class="c1">###### SINGLE POSE EDITS ########</span>
<div class="viewcode-block" id="FaceStagingUI.single_pose_toggle"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.single_pose_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">single_pose_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is a toggle for starting the single pose edit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pose_edit_start_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">single_pose_edit_start</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Single Pose Edit&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span><span class="p">:</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_end</span><span class="p">(</span><span class="n">due_mirror</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">due_export</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">transfer_jnts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reparent_rivet_group</span><span class="p">()</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Single Pose Edit Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span><span class="p">:</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">paint_neutral_end</span><span class="p">()</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_end</span><span class="p">(</span><span class="n">due_mirror</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">due_export</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">transfer_jnts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reparent_rivet_group</span><span class="p">()</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Paint Neutral Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Single Pose Edit Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.single_pose_edit_start"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.single_pose_edit_start">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">single_pose_edit_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frag_rig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Single pose edit.</span>

<span class="sd">        :param FRAGRig frag_rig: FRAG Rig Component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">pose_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pose_from_listwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_name</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Pose Selected&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please select a pose from the active pose list.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="n">face_pose_edit</span><span class="o">.</span><span class="n">FacePoseEdit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">main_pose</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">frag_node</span><span class="o">=</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_start</span><span class="p">(</span><span class="n">show_skel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">symmetry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">transfer_jnts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_ACTIVE_COLORS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_color_frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BACKGROUND_GREY</span><span class="p">)</span></div>

    <span class="c1">###### Multi POSE EDITS ########</span>
<div class="viewcode-block" id="FaceStagingUI.multi_pose_toggle"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.multi_pose_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">multi_pose_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is a toggle for starting the multi pose edit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pose_edit_start_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="n">start_multi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_pose_edit_start</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">start_multi</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_ACTIVE_COLORS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multi_pose_edit_frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BACKGROUND_GREY</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Multi Pose Edit&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">multi_pose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span><span class="p">:</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_end</span><span class="p">(</span><span class="n">multi_edit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">due_mirror</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">auto_mirror_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">due_export</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">transfer_jnts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reparent_rivet_group</span><span class="p">()</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Multi Pose Edit Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.multi_pose_edit_start"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.multi_pose_edit_start">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">multi_pose_edit_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frag_rig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Single pose edit.</span>

<span class="sd">        :param FRAGRig frag_rig: FRAG Rig Component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">pose_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pose_from_listwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_name</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Pose Selected&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please select a pose from the active pose list.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">edit_node</span> <span class="o">=</span> <span class="n">face_pose_edit</span><span class="o">.</span><span class="n">FacePoseEdit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">main_pose</span><span class="o">=</span><span class="n">pose_name</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">frag_node</span><span class="o">=</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_start</span><span class="p">(</span><span class="n">multi_edit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">show_skel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">symmetry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">transfer_jnts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FaceStagingUI.pose_edit_cancel"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.pose_edit_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">pose_edit_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cancels the Single and Multi pose edits.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">multi_pose</span><span class="p">:</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">paint_neutral_cancel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">(</span><span class="n">keep_single</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Paint Neutral Canceled&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_transfer_joints_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">blendshape</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
                <span class="n">blendshape</span><span class="o">.</span><span class="n">connect_joints</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reparent_rivet_group</span><span class="p">()</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">pose_edit_cancel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_list_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">edit_percent_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pose_flag_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Pose Edit Canceled&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

    <span class="c1">####### Paint Neutral ##########</span>
<div class="viewcode-block" id="FaceStagingUI.paint_neutral_toggle"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.paint_neutral_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">paint_neutral_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blend Shape mode refers to &quot;Paint Neutral Pose&quot; on the UI.  The button is a toggle.</span>
<span class="sd">        This determines which function to execute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pose_edit_start_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">pose_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pose_from_listwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pose_name</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Pose Selected&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please select a pose from the active pose list.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">single_pose_edit_start</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Single Pose Edit&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
            <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paint_neutral_start</span><span class="p">(</span><span class="n">edit_node</span><span class="p">)</span>
            <span class="c1"># set button color</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_frame</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Paint Neutral Pose&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paint_neutral_start</span><span class="p">(</span><span class="n">edit_node</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Paint Neutral Pose&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edit_buttons_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_pushButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">paint_neutral_frame</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">single_pose</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">paint_neutral</span><span class="p">:</span>
            <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">paint_neutral_end</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">(</span><span class="n">keep_single</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Paint Neutral Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.paint_neutral_start"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.paint_neutral_start">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">paint_neutral_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edit_node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blend Shape mode refers to &quot;Paint Neutral Pose&quot; on the UI.</span>
<span class="sd">        In order for this function to work the user must be in edit mode.</span>
<span class="sd">        This creates a blend shape from the base head to the pose mesh that is being modified.</span>
<span class="sd">        This will allow the user to paint back</span>
<span class="sd">        the neutral pose onto the pose mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">symmetry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">paint_neutral_start</span><span class="p">(</span><span class="n">symmetry</span><span class="p">)</span></div>

    <span class="c1">####### Base Mesh Edit ##########</span>
<div class="viewcode-block" id="FaceStagingUI.base_edit_toggle"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.base_edit_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">base_edit_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blend Shape mode refers to &quot;Paint Neutral Pose&quot; on the UI.  The button is a toggle.</span>
<span class="sd">        This determines which function to execute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Rig&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cannot not find the FRAG Rig node.</span><span class="se">\n</span><span class="s1">No rig in the scene.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_edit_start</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_edit_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BUTTON_ACTIVE_COLORS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">base_color_edit_frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">STAGING_BACKGROUND_GREY</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Entered Base Edit Mode&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">edit_node</span> <span class="ow">and</span> <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">base_edit</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_dialog</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Finish Editing?&#39;</span><span class="p">,</span>
                                                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Do you wish to continue?  The changes will be propagated out &#39;</span>
                                                            <span class="s1">&#39;to all of the blend shapes.&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
                    <span class="k">return</span>

            <span class="n">edit_node</span><span class="o">.</span><span class="n">base_edit_end</span><span class="p">(</span><span class="n">due_export</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">export_skin_meshes_as_fbx</span><span class="p">()</span>
            <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">set_all_flag_block_values</span><span class="p">()</span>
            <span class="n">pm</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">pynode</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Base Edit Successful!&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.base_edit_start"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.base_edit_start">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">base_edit_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frag_rig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the editing process where the base mesh can be edited.</span>

<span class="sd">        :param FRAGRig frag_rig: FRAG Rig Component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">edit_node</span> <span class="o">=</span> <span class="n">face_pose_edit</span><span class="o">.</span><span class="n">FacePoseEdit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">main_pose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frag_node</span><span class="o">=</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">base_edit_start</span><span class="p">(</span><span class="n">symmetry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">symmetry_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                                    <span class="n">show_skel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">show_skeleton_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div>

<div class="viewcode-block" id="FaceStagingUI.base_edit_cancel"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.base_edit_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">base_edit_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cancels the Base Edit mode and returns the scene back to a clean state.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edit_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edit_node</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">edit_node</span><span class="o">.</span><span class="n">base_edit_cancel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Base Edit Mode Canceled&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.replace_base_mesh"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.replace_base_mesh">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">replace_base_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces the base mesh with a newer mesh with the same vert count.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Replace Base Mesh?&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Do you wish to continue?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selection</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">listRelatives</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Select a Mesh&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Please select a valid mesh&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">replacement_mesh</span> <span class="o">=</span> <span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_rig</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;No Rig&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cannot not find the FRAG Rig node.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                                        <span class="s1">&#39;No rig in the scene.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blendshape_mesh_from_qlistwidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">edit_node</span> <span class="o">=</span> <span class="n">face_pose_edit</span><span class="o">.</span><span class="n">FacePoseEdit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">main_pose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frag_node</span><span class="o">=</span><span class="n">frag_rig</span><span class="p">)</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">replace_base</span><span class="p">(</span><span class="n">replacement_mesh</span><span class="p">,</span> <span class="n">due_export</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">export_bs_checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">export_skin_meshes_as_fbx</span><span class="p">()</span>
        <span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">set_all_flag_block_values</span><span class="p">()</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">edit_node</span><span class="o">.</span><span class="n">edit_inst</span><span class="o">.</span><span class="n">pynode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_pose_edit_buttons</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.print_test"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.print_test">[docs]</a>    <span class="k">def</span> <span class="nf">print_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Function to test things.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">button</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">single_edit_pushButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
            <span class="s1">&#39;background-color: rgb{0.207843, 0.207843, 0.207843, 1.000000};&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.get_text_from_list_widget"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_text_from_list_widget">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qlist_widget</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string from a selected row in a list Widget.</span>

<span class="sd">        :param QListWidget qlist_widget: A QT QListWidget.</span>
<span class="sd">        :return: Returns a string from a selected row in a list Widget.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">qlist_widget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
            <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qlist_widget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">selected</span></div>

<div class="viewcode-block" id="FaceStagingUI.select_item_from_list_widget"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.select_item_from_list_widget">[docs]</a>    <span class="k">def</span> <span class="nf">select_item_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qlist_widget</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects objs from the QListWidget.</span>
<span class="sd">        :param QListWidget qlist_widget: A QT QListWidget.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="n">qlist_widget</span><span class="p">)</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">objExists</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span></div>

    <span class="c1">################################################</span>
    <span class="c1"># Rigging Tab</span>
    <span class="c1">################################################</span>
<div class="viewcode-block" id="FaceStagingUI.get_rigging_selected_meshes"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.get_rigging_selected_meshes">[docs]</a>    <span class="k">def</span> <span class="nf">get_rigging_selected_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of mesh names from the QListWidgets</span>

<span class="sd">        :return: Returns a list of mesh names from the QListWidgets</span>
<span class="sd">        :rtype: list(str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">skinned_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="p">)</span>
        <span class="n">blendshapes_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="p">)</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="n">skinned_meshes</span> <span class="o">+</span> <span class="n">blendshapes_meshes</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">meshes</span> <span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">objExists</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="nf">_populate_skinning_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populates the mesh QListWidgets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Clear List widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="n">skinned_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="n">blendshapes_meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_blendshape_meshes</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">skinned_meshes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">blendshapes_meshes</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">skinned_meshes</span><span class="p">:</span>
            <span class="n">skinned_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">skinned_meshes</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">blendshapes_meshes</span><span class="p">:</span>
            <span class="n">blendshapes_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">blendshapes_meshes</span><span class="p">))</span>

        <span class="c1"># Check to see if they have skinning data</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">skinned_meshes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">face_util</span><span class="o">.</span><span class="n">has_skinning_data</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">):</span>
                <span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_RED</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">blendshapes_meshes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">face_util</span><span class="o">.</span><span class="n">has_skinning_data</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">):</span>
                <span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QLabelTextButtonQWidget</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_RED</span><span class="p">)</span>

<div class="viewcode-block" id="FaceStagingUI.restore_skinning"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.restore_skinning">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">restore_skinning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restores skinning from saved skin weights in a .sknr file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Restore Skinning?&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Restore Skinning?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigging_selected_meshes</span><span class="p">()</span>
        <span class="n">not_skinned</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">face_util</span><span class="o">.</span><span class="n">has_skinning_data</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">):</span>
                <span class="n">face_skinning</span><span class="o">.</span><span class="n">apply_face_skinning_from_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">not_skinned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">not_skinned</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">not_skinned</span><span class="p">)</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Meshes were not skinned&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="s1">&#39;These meshes were not skinned</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_skinning"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_skinning">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_skinning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_meshes</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the skin weights to a .json file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Export Skinning?&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Export Skinning?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">all_meshes</span><span class="p">:</span>
            <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigging_selected_meshes</span><span class="p">()</span>
        <span class="n">not_exported</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
            <span class="n">skin_saved</span> <span class="o">=</span> <span class="n">face_skinning</span><span class="o">.</span><span class="n">export_face_skinning_to_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">skin_saved</span><span class="p">:</span>
                <span class="n">not_exported</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">not_exported</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">not_exported</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">info_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Meshes were not skinned&#39;</span><span class="p">,</span>
                                            <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;These meshes were not skinned</span><span class="se">\n</span><span class="s1">&#39;</span>
                                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">blendshape_skin_listWidget</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_skinning_meshes</span><span class="p">()</span></div>

<div class="viewcode-block" id="FaceStagingUI.export_all_skinning"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.export_all_skinning">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">export_all_skinning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_skinning</span><span class="p">(</span><span class="n">all_meshes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.process_skinning"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.process_skinning">[docs]</a>    <span class="k">def</span> <span class="nf">process_skinning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skinned_meshes</span><span class="p">,</span> <span class="n">delete_decomp_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes skinning on a list of meshes based on information in rig source data</span>

<span class="sd">        :param list(pm.nt.Transform) skinned_meshes: Face meshes to process skinning on</span>
<span class="sd">        :param bool delete_decomp_mesh: Deletes the mesh created by LSD process.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Making sure head is first so other meshes can potentially be copied from it</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="n">mesh_markup_rig</span><span class="o">.</span><span class="n">RigMeshMarkup</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="n">face_mesh</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">markup</span><span class="o">.</span><span class="n">get_mesh_list_in_region</span><span class="p">(</span><span class="s1">&#39;head_mesh&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">face_blendshape</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">markup</span><span class="o">.</span><span class="n">get_mesh_list_in_region</span><span class="p">(</span><span class="s1">&#39;head_blendshape&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">face_mesh</span> <span class="ow">in</span> <span class="n">skinned_meshes</span><span class="p">:</span>
            <span class="n">skinned_meshes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">face_mesh</span><span class="p">)</span>
            <span class="n">skinned_meshes</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">face_mesh</span><span class="p">)</span>

        <span class="n">display_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">naming</span><span class="o">.</span><span class="n">get_basename</span><span class="p">(</span><span class="n">skinned_mesh</span><span class="p">)</span> <span class="k">for</span> <span class="n">skinned_mesh</span> <span class="ow">in</span> <span class="n">skinned_meshes</span><span class="p">]</span>

        <span class="n">message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">display_names</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_dialog</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Process Skinning?&#39;</span><span class="p">,</span>
                                            <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Process skinning for:</span><span class="se">\n</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="n">prog_ui</span> <span class="o">=</span> <span class="n">progressbar_ui</span><span class="o">.</span><span class="n">ProgressBarStandard</span><span class="p">()</span>
        <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Starting Up&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">skinned_meshes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">skin_utils</span><span class="o">.</span><span class="n">get_skin_cluster_from_geometry</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">face_blendshape</span><span class="p">)):</span>
            <span class="n">face_skinning</span><span class="o">.</span><span class="n">apply_common_skinning</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">face_blendshape</span><span class="p">),</span> <span class="s1">&#39;head_mesh&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">skinned_mesh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skinned_meshes</span><span class="p">):</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">i</span>
            <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Skinning </span><span class="si">{</span><span class="n">skinned_mesh</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
            <span class="n">face_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_face_component</span><span class="p">()</span>
            <span class="n">blendshape_mesh</span> <span class="o">=</span> <span class="n">face_component</span><span class="o">.</span><span class="n">get_counterpart_mesh</span><span class="p">(</span><span class="n">skinned_mesh</span><span class="p">)</span>

            <span class="n">skin_mesh</span> <span class="o">=</span> <span class="n">face_model</span><span class="o">.</span><span class="n">FaceModel</span><span class="p">(</span><span class="n">skinned_mesh</span><span class="p">)</span>

            <span class="n">region_data</span> <span class="o">=</span> <span class="n">source_data</span><span class="o">.</span><span class="n">FaceMeshRegionData</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_face_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">skinned_joints</span> <span class="o">=</span> <span class="n">region_data</span><span class="o">.</span><span class="n">joints_skinned</span>

            <span class="n">initial_skinning_process</span> <span class="o">=</span> <span class="n">region_data</span><span class="o">.</span><span class="n">skinning_initial</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skinned_joints</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">initial_skinning_process</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">:</span>
                <span class="n">face_skinning</span><span class="o">.</span><span class="n">copy_weights_from_head</span><span class="p">(</span><span class="n">face_mesh</span><span class="p">,</span> <span class="n">region_data</span><span class="p">,</span> <span class="p">[</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">initial_skinning_process</span> <span class="o">==</span> <span class="s2">&quot;process&quot;</span> <span class="ow">and</span> <span class="n">blendshape_mesh</span><span class="p">:</span>
                <span class="n">start_frame</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">playbackOptions</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">end_frame</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">playbackOptions</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pm</span><span class="o">.</span><span class="n">keyframe</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">skinned_joints</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">listAttr</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">query</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keyframeCount</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">calibration_animation</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">mel</span><span class="o">.</span><span class="n">findRelatedSkinCluster</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">))</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">pm</span><span class="o">.</span><span class="n">skinCluster</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">getShape</span><span class="p">(),</span> <span class="n">e</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">face_skinning</span><span class="o">.</span><span class="n">face_skinning_converter_cmd</span><span class="p">(</span><span class="n">blendshape_mesh</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">blendshape_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">),</span>
                                                          <span class="n">skin_mesh</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">),</span>
                                                          <span class="n">joints</span><span class="o">=</span><span class="n">skinned_joints</span><span class="p">,</span>
                                                          <span class="n">start_frame</span><span class="o">=</span><span class="n">start_frame</span><span class="p">,</span>
                                                          <span class="n">end_frame</span><span class="o">=</span><span class="n">end_frame</span><span class="p">,</span>
                                                          <span class="n">delete_decomp_mesh</span><span class="o">=</span><span class="n">delete_decomp_mesh</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">cut_animation</span><span class="p">()</span>

                <span class="n">frag_rigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rigs</span><span class="p">()</span>
                <span class="n">frag_rig</span> <span class="o">=</span> <span class="n">frag_rigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">root_joint</span> <span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">get_root_joint</span><span class="p">(</span><span class="n">frag_rig</span><span class="p">)</span>
                <span class="n">wrapped_root</span> <span class="o">=</span> <span class="n">chain_markup</span><span class="o">.</span><span class="n">ChainMarkup</span><span class="p">(</span><span class="n">root_joint</span><span class="p">)</span>

                <span class="n">face_skinning</span><span class="o">.</span><span class="n">post_lsd_face_cleanup</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span>
                                                    <span class="n">region_data</span><span class="p">,</span>
                                                    <span class="n">wrapped_root</span><span class="p">,</span>
                                                    <span class="n">asset_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>

                <span class="n">blendshape_mesh</span><span class="o">.</span><span class="n">connect_joints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">delete_old_rivet_grp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">initial_skinning_process</span> <span class="o">==</span> <span class="s2">&quot;saved&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">zero_flags</span><span class="p">()</span>
                <span class="n">face_skinning</span><span class="o">.</span><span class="n">apply_common_skinning</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">skin_mesh</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">initial_skinning_process</span> <span class="o">==</span> <span class="s2">&quot;maya_default&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">mel</span><span class="o">.</span><span class="n">findRelatedSkinCluster</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">))</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">pm</span><span class="o">.</span><span class="n">skinCluster</span><span class="p">(</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">getShape</span><span class="p">(),</span> <span class="n">e</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pm</span><span class="o">.</span><span class="n">skinCluster</span><span class="p">(</span><span class="n">skinned_joints</span><span class="p">,</span> <span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">tsb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">skin_mesh</span><span class="o">.</span><span class="n">mesh</span><span class="si">}</span><span class="s1"> Skinned Successfully&#39;</span><span class="p">,</span>
                                         <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span>
                                         <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
        <span class="n">prog_ui</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;Finished&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.all_meshes_process_skinning"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.all_meshes_process_skinning">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">all_meshes_process_skinning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the skinning for all tagged skinned face meshes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_skinned_meshes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_skinning</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="n">delete_decomp_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_dialog</span><span class="o">=</span><span class="n">skip_dialog</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.process_skinning_keep_mesh"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.process_skinning_keep_mesh">[docs]</a>    <span class="k">def</span> <span class="nf">process_skinning_keep_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the skinning and then Does not delete the mesh that the LSD gives after the process.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_skinning</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="n">delete_decomp_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.process_skinning_delete_mesh"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.process_skinning_delete_mesh">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">process_skinning_delete_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the skinning and then deletes the mesh that the LSD gives after the process.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meshes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_from_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">engine_meshes_listWidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_skinning</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="n">delete_decomp_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.reparent_rivet_group"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.reparent_rivet_group">[docs]</a>    <span class="k">def</span> <span class="nf">reparent_rivet_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-parents rivet group under DNT group</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rivet_group</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">xform</span> <span class="k">for</span> <span class="n">xform</span> <span class="ow">in</span> <span class="n">pm</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">nt</span><span class="o">.</span><span class="n">Transform</span><span class="p">)</span> <span class="k">if</span> <span class="n">xform</span><span class="o">.</span><span class="n">hasAttr</span><span class="p">(</span><span class="s1">&#39;isRivetGrp&#39;</span><span class="p">)),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rivet_group</span><span class="p">:</span>
            <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
            <span class="n">dnt_group</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">getAttr</span><span class="p">(</span><span class="s1">&#39;doNotTouch&#39;</span><span class="p">)</span>
            <span class="n">rivet_group</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">dnt_group</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.finish_save_rig"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.finish_save_rig">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">track_fnc</span>
    <span class="k">def</span> <span class="nf">finish_save_rig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves and cleans up the final rig file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">dialogs</span><span class="o">.</span><span class="n">question_prompt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Save Rig?&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Clean up the File and Save Rig?&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">face_util</span><span class="o">.</span><span class="n">clean_and_save_face_rig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">display_view_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Rig File Saved Successfully&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Face Staging Tool&#39;</span><span class="p">,</span> <span class="n">fade_time</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span></div>

<div class="viewcode-block" id="FaceStagingUI.create_flags_from_common"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.FaceStagingUI.create_flags_from_common">[docs]</a>    <span class="k">def</span> <span class="nf">create_flags_from_common</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">flag_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_asset_rig_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">),</span> <span class="s1">&#39;Flags&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">flag_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">flag_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">flag_path</span><span class="p">):</span>
            <span class="n">common_flag_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">get_common_face</span><span class="p">(),</span> <span class="s1">&#39;Flags&#39;</span><span class="p">)</span>
            <span class="n">frag_rig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rig</span><span class="p">()</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="n">frag_rig</span><span class="o">.</span><span class="n">get_flags</span><span class="p">()</span>
            <span class="n">frag_flag</span><span class="o">.</span><span class="n">swap_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">common_flag_path</span><span class="p">)</span>
            <span class="n">frag_rig</span><span class="o">.</span><span class="n">color_flags</span><span class="p">()</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">serialize_flag</span><span class="o">.</span><span class="n">export_flag</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">flag_path</span><span class="p">),</span> <span class="n">flags</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div></div>

<div class="viewcode-block" id="QLabelTextQWidget"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextQWidget">[docs]</a><span class="k">class</span> <span class="nc">QLabelTextQWidget</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QLabelTextQWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">setSizeConstraint</span><span class="p">(</span><span class="n">QLayout</span><span class="o">.</span><span class="n">SetMinimumSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>

<div class="viewcode-block" id="QLabelTextQWidget.set_text"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextQWidget.set_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a nested text to be added to a QListWidget.</span>

<span class="sd">        :param str text: Sets a nested text to be added to a QListWidget.</span>
<span class="sd">        :param str color: The color of the text.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;color: rgb</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="QLabelTextQWidget.create"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextQWidget.create">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qlist_widget</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_GREEN</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a nested text to be added to a QListWidget.</span>

<span class="sd">        :param QListWidget qlist_widget: A QT QListWidget.</span>
<span class="sd">        :param str text: Sets a nested text to be added to a QListWidget.</span>
<span class="sd">        :param str color: The color of the text.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">myQCustomQWidget</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="c1"># Create QListWidgetItem</span>
        <span class="n">myQListWidgetItem</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">qlist_widget</span><span class="p">)</span>
        <span class="n">myQListWidgetItem</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">text_QLabel</span><span class="p">)</span>
        <span class="c1"># Set size hint</span>
        <span class="n">myQListWidgetItem</span><span class="o">.</span><span class="n">setSizeHint</span><span class="p">(</span><span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">minimumSizeHint</span><span class="p">())</span>
        <span class="c1"># Add QListWidgetItem into QListWidget</span>
        <span class="n">qlist_widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">myQListWidgetItem</span><span class="p">)</span>
        <span class="n">qlist_widget</span><span class="o">.</span><span class="n">setItemWidget</span><span class="p">(</span><span class="n">myQListWidgetItem</span><span class="p">,</span> <span class="n">myQCustomQWidget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="QLabelTextButtonQWidget"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget">[docs]</a><span class="k">class</span> <span class="nc">QLabelTextButtonQWidget</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QLabelTextButtonQWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">setSizeConstraint</span><span class="p">(</span><span class="n">QLayout</span><span class="o">.</span><span class="n">SetMinimumSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QHBoxLayout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_vis</span><span class="p">)</span>

<div class="viewcode-block" id="QLabelTextButtonQWidget.set_vis"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.set_vis">[docs]</a>    <span class="k">def</span> <span class="nf">set_vis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the vis of the mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_obj</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_button_text</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">())</span></div>

<div class="viewcode-block" id="QLabelTextButtonQWidget.check_obj"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.check_obj">[docs]</a>    <span class="k">def</span> <span class="nf">check_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to make sure a object exists.</span>

<span class="sd">        :return: Returns a pynode of the object.</span>
<span class="sd">        :rtype: pm.nt.DagNode</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">objExists</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pm</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="QLabelTextButtonQWidget.check_button_text"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.check_button_text">[docs]</a>    <span class="k">def</span> <span class="nf">check_button_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the v in the visibility button.</span>

<span class="sd">        :param value:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="QLabelTextButtonQWidget.set_text"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.set_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_WHITE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the text for the QLabel</span>

<span class="sd">        :param str text: The text to be entered into the Qlabel</span>
<span class="sd">        :param str color: The RBG color code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;color: rgb</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_QLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="QLabelTextButtonQWidget.set_button_text"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.set_button_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_button_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_WHITE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the text for the QPushButton</span>

<span class="sd">        :param str text: The text put onto the QPushButton</span>
<span class="sd">        :param str color: The RBG color code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;color: rgb</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">;&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;text-align: Center;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="QLabelTextButtonQWidget.create"><a class="viewcode-back" href="../../../../../cpg.maya.tools.face_staging.html#cpg.maya.tools.face_staging.face_staging_ui.QLabelTextButtonQWidget.create">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qlist_widget</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">button_text</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">STAGING_COLOR_WHITE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a nested text with a nested button to be added to a QListWidget.</span>

<span class="sd">        :param QListWidget qlist_widget: A QT QListWidget.</span>
<span class="sd">        :param str text: Sets a nested text to be added to a QListWidget.</span>
<span class="sd">        :param str button_text: Sets the text in the button.</span>
<span class="sd">        :param str color: The color of the text.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">myQCustomQWidget</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">set_button_text</span><span class="p">(</span><span class="n">button_text</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">check_obj</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">check_button_text</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="c1"># Create QListWidgetItem</span>
        <span class="n">myQListWidgetItem</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">qlist_widget</span><span class="p">)</span>
        <span class="n">myQListWidgetItem</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">text_QLabel</span><span class="p">)</span>
        <span class="n">myQListWidgetItem</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">button</span><span class="p">)</span>
        <span class="c1"># Set size hint</span>
        <span class="n">myQListWidgetItem</span><span class="o">.</span><span class="n">setSizeHint</span><span class="p">(</span><span class="n">myQCustomQWidget</span><span class="o">.</span><span class="n">minimumSizeHint</span><span class="p">())</span>
        <span class="c1"># Add QListWidgetItem into QListWidget</span>

        <span class="n">qlist_widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">myQListWidgetItem</span><span class="p">)</span>
        <span class="n">qlist_widget</span><span class="o">.</span><span class="n">setItemWidget</span><span class="p">(</span><span class="n">myQListWidgetItem</span><span class="p">,</span> <span class="n">myQCustomQWidget</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Rigging Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>